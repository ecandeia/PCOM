\chapter{Transmissão de Sinais}

Até o momento foram apresentados os princípios básicos sobre como pode-se obter um sinal que transporta uma mensagem e como um receptor consegue recuperar a mensagem enviada usando a demodulação. Entretanto, consideramos o sinal recebido é exatamente o que foi transmitido, ou seja, durante a propagação entre o transmissor e o receptor o sinal não é alterado pelo meio em que ele se propaga. Neste capítulo vamos discutir os efeitos das características do meio de transmissão sobre um sinal durante a sua propagação entre o transmissor e o receptor.

\section{Transmissão sem Distorção Através de Sistemas Lineares}

Vamos estudar o que acontece com um sinal quando ele é transmitido entre dois pontos, denominados de transmissor e receptor, através de um meio físico denominado de canal de comunicação, como está representado na Figura~\ref{fig:sistemasimples}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/sistemasimples.eps,width=7cm}}
\caption{\label{fig:sistemasimples}Representação Simplificada de um Sistema de Comunicações.}
\end{figure}
%*******************

O sinal enviado $s(t)$ se propagará pelo canal de comunicação e estará sujeito à interferências impostas pelo canal. Sendo $F[]$ a função que descreve o comportamento do canal, a relação da entrada com a saída será 
\[
 r(t) = F[s(t)].
\]
A determinação da função $F[]$ é um dos grandes problemas em telecomunicações. 
%Na saída o receptor obterá $r(t)$, uma versão de $s(t)$ alterada, a partir da qual tentará recuperar a mensagem enviada.

Inicialmente vamos analisar o canal de comunicações como um sistema linear, lembrando que um sistema desse tipo deve satisfazer as seguintes propriedades:
\begin{enumerate}
\item a resposta a uma soma de excitações é igual a soma das
respostas das excitações tomadas individualmente, ou seja, se a entrada for dada por
\[
 r(t) = \sum_{k}a_k s_k(t)
\]
sendo os $a_k$ constantes, então a saída será dada por
\[
 r(t) = \sum_k a_k F[s_k(t)];
\]
\item as relações entre a entrada e a saída são invariantes, ou seja,
\[
 F[s(t-t_d)] = r(t-t_d).
\]
\end{enumerate}
A primeira condição é o princípio da superposição, enquanto a segunda
implica que os elementos do sistema não variam com o tempo.

Dessa forma podemos ver o canal de comunicação como o sistema linear da Figura~\ref{fig:sistemalinear}, 
o sinal $s(t)$ é processado de acordo com as características do sistema ($h(t)$) para
produzir $r(t)$.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/sistemalinear.eps,width=5cm}}
\caption{\label{fig:sistemalinear}Sistema Linear.}
\end{figure}
%*******************


Se $H(\omega)$ é a função de transferência do sistema linear, então
\[
 r(t) = s(t)*h(t)
\]
ou pela propriedade da transformada de Fourier da convolução
\[
R(\omega) = S(\omega)H(\omega)
\]
colocando na forma polar
\begin{eqnarray}
R(\omega) &=& \mid S(\omega)\mid e^{j\theta_s(\omega)} \mid H(\omega)\mid e^{j\theta_h(\omega)}\nonumber \\
&=&  \mid S(\omega)\mid \mid H(\omega)\mid e^{j[\theta_g(\omega) + \theta_h(\omega)]}.
\end{eqnarray}
e algumas questões importantes podem ser colocadas neste instante:
\begin{enumerate}
\item que relações devem existir entre $\mid H(\omega)\mid$, $\theta_h(\omega)$ e $\mid G(\omega)\mid$ e
$\theta_g(\omega)$ para preservar a forma de onda do sinal de entrada na saída
\item que filtro é obtido na forma de onda da saída em comparação com a entrada
pelas variações de $\mid H(\omega)\mid$?
\item o mesmo para $\theta_h(\omega)$
\item como a distorção do sinal está relacionada com a largura de faixa do sistema?
\end{enumerate}

Iniciemos pela primeira questão, pois nos sistemas de comunicação queremos sempre minimizar as distorções cusadas pelas
imperfeições do canal, e no caso ideal obter uma transmissão sem distorção.

Uma transmissão é dita sem distorção se a entrada e a saída tem a mesma forma de onda, possivelmente escalonada (multiplicada por um fator $k$ que pode atenuar ou amplificar o sinal)\footnote{Vale observar que em um canal de comunicações, sempre ocorrerá a atenuação do sinal}. Como o sinal levará um tempo para atingir a saída do sistema, será incluido um atraso, porém uma transmissão que inclua um atraso na saída e que mantenha a forma de onda de entrada ainda é considerada sem distorção.

Assim, para uma transmissão sem distorção
\[
r(t) = ks(t-t_d)
\]
sendo $t_d$ um atraso que não altera a forma de onda do sinal transmitido. 
Pela propriedade do deslocamento
\begin{eqnarray}
R(\omega) &=&  kS(\omega)e^{-\omega t_d} \nonumber \\
&=& k e^{-j\omega t_d}S(\omega) = H(\omega)S(\omega)
\end{eqnarray}
logo
\[
H(\omega) = ke^{-j\omega t_d}.
\]
Fazer $\mid H(\omega)\mid = k$ quer dizer que todas as componentes de frequência
devem sofrer a mesma atenuação ou amplificação.

Além disso deve-se ter $\theta_H(\omega) = -\omega t_d$ e isto quer dizer que a fase é proporcional
a $\omega$, de forma que todas as componentes de frequência sofram o mesmo
atraso $t_d$ ($\cos\omega(t-t_d) = \cos(\omega t - \omega t_d$)).

Dessa forma, para uma transmissão sem distorção o módulo e a fase de $H(\omega)$ devem ter o formato mostrado na Figura~\ref{fig:homegalinear}, e como já foi dito, sistemas reais são no máximo uma aproximação dos sistemas sem distorção.


%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/homegalinear.eps,width=7cm}}
\caption{\label{fig:homegalinear}Módulo e fase da função $H(\omega)$ que não distorce o sinal de entrada.}
\end{figure}
%*******************



\begin{exemplo} Determinar a função de transferência $H(\omega)$ e desenhar $\mid H(\omega)\mid$
e $\theta_h(\omega)$ de um circuito RC mostrado na Figura~\ref{fig:circuitorc}.
Para transmistir sem distorção, que restição devemos impor na largura de faixa de
$g(t)$? Qual é o atraso de transmissão? Ache $y(t)$ quando $g(t) = A\cos 100t$.
\end{exemplo}

%%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/circuitorc.eps,width=5cm}}
\caption{\label{fig:circuitorc}Circuito RC.}
\end{figure}
%%*******************

\subsubsection{Solução}

Para o circuito da Figura~\ref{fig:circuitorc} tem-se
\begin{eqnarray}
H(\omega) &=& \frac{Z_c}{j\omega + Z_c} = \frac{1/j\omega C}{R+ 1/j\omega C} =
\frac{1}{(jR\omega C +1)} \nonumber \\
&=& \frac{1/RC}{1/RC + j\omega} = \frac{a}{a+j\omega}
\nonumber
\end{eqnarray}
sendo $a = 1/RC = 10^6$. Assim, na forma polar tem-se
\[
\mid H(\omega)\mid = \frac{1}{\sqrt{a^2 + \omega^2}}\ \text{ e }\ \theta_h(\omega) = -tan^{-1}\frac{\omega}{a}.
\]

Quando $\omega << a$ pode-se dizer que $\mid H(\omega) \mid \approx 1$ e
$\theta_h(\omega)\approx -\omega/a$, ou que temos uma transmissão sem
distorção, quase ideal. Por exemplo, para $\omega < 0,2a$, $\mid H(\omega)\mid$ desvia
2\% de um e $\theta_h(\omega)$ de 1,5\% do ideal.

Então para um sinal de largura de faixa $B << \frac{a}{2\pi} Hz$ a transmissão é praticamente sem
distorção. O valores de $B$ dependem da quantidade de distorção que pode ser tolerada.

Para $\omega = 0,2a$ ou $2\pi B = 200.000$ $B\approx 31.847Hz$ temos uma distorção
desprezíval.

O atraso $t_d$ é dado por
\[
t_d = \frac{d\theta_h(\omega)}{d\omega} = \frac{a}{\omega^2 + a^2}
\]
No caso ideal $\theta_h(\omega) = -\omega t_d \approx -\omega/a$ e
$t_d \approx 1/a = RC = 10^{-6}$.

Para uma entrada $Acos 100t$, com $100 << 10 ^6$
\[
y(t) = A\cos 100(t-10^{-6})  A\cos(100t - 10^{-4})
\]

Na prática, variações de $1/\sqrt{2} \approx 0,707$ do valor de $\mid H(\omega)\mid$
são consideradas toleráveis, e o intervalo de frequência no qual $\mid H(\omega)\mid$
permanece dentro desta variação (3dB) é chamado de largura de faixa do sistema (filtro).
No nosso exemplo $\mid H(\omega)\mid = 0,707$  em $\omega RC =1$. Nesta faixa de frequências
$\theta_h$ varia dede 0,215 radianos em relação a sua característica linear ideal.


\section{ Distorção do Sinal através de um Canal}

Como foi dito, durante a transmissão o sinal enviado através de um canal é distorcido devido às imperfeições
do mesmo. Como será mostrado as distorções podem ser lineares ou não lineares.

\subsection{Distorção Linear}

Primeiro vamos considerar canais lineares e invariantes no tempo. Distorções podem
ser causadas por características não ideais de
\begin{itemize}
\item magnitude,
\item fase
\item ou ambas
\end{itemize}

Na nossa análise utilizaremos um pulso $x(t)$ transmitido através do canal. Suponhamos que
o pulso exista no intervalo de tempo $(a,b)$ e que seja zero fora desse intervalo.
Sabemos que $x(t)$ pode ser representado por seu espectro (de magnitude e de fase).

Já foi mostrado que a transmissão de $x(t)$ através de um canal ideal sem distorção deixa este espectro
imperturbado, pois todas as componentes são multiplicadas por um mesmo fator e sofrem
o mesmo atraso.

Se a magnitude do canal não é ideal ($\mid H(\omega)\mid$ não é constante)
o espectro então será perturbado e a soma de todas as componentes de frequência
pode não ser zero fora do intervalo $(a,b)$.

Em suma, o pulso é espalhado no tempo. O mesmo raciocínio pode ser empregado
para fase não ideal, $\theta_h(\omega) \neq -\omega t_d$. Esse espalhamento
é chamado de dispersão.

Este tipo de distorção é altamente indesejável nos sistemas de
multiplexação no tempo como o TDM ({\em Time Division Multiplexing}),
pois pode fazer com que pulsos vizinhos interfiram entrre si,
provocando interferência intersimbólica e ``{\em crosstalk}'',
interferência nos canais vizinhos.
Nos sistemas de multiplexação em frequência como o FDM ({\em Frequency
  Division Mulriplexing}), o sinal é distorcido  mas não afeta os canais vizinhos.

\begin{exemplo}\label{ex:filtroideal}
Considere a função de transferência de um canal de comunicação é dado por
\[
h(\omega) = \left\{
\begin{array}{c c}
(1 + k\cos T\omega)e^{-j\omega t_d} & \mid\omega\mid < 2\pi B \\
0 & \mid\omega\mid > 2\pi B
\end{array}
\right.
\]
que está representada na Figura~\ref{fig:espectrofiltroideal}, e que
um pulso $x(t)$ com largura de banda limitada a $B$Hz é aplicado a entrada desse canal, vamos analisar que sinal é obtido na saída. 


%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/espectrofiltroideal.eps,width=9cm}}
\caption{\label{fig:espectrofiltroideal}Espectro do canal de comunicação do Exemplo~\ref{ex:filtroideal}.}
\end{figure}
%*******************

Seja $x(t) \leftrightarrow X(\omega)$ e  $y(t)\leftrightarrow Y(\omega)$, logo

\begin{eqnarray}
Y(\omega) &=& X(\omega)H(\omega) \nonumber \\
&=& X(\omega)[1 + k\cos T\omega]e^{-j\omega t_d} \nonumber \\
&=& X(\omega)e^{-j\omega t_d} + k[X(\omega)\cos T\omega]e^{-j\omega t_d}
\end{eqnarray}

Usando a propriedade de deslocamento no tempo e o seguinte fato
\[
x(t-t_0) + x(t+t_0) \leftrightarrow 2X(\omega)\cos t_0\omega
\]
\[
y(t) = x(t-t_d) + \frac{k}{2}[x(t-T-t_d)+x(t+T-t_d)]
\]
que consiste no pulso $x(t)$ atrasado de $t_d$ mais dois outros pulso $x(t)$
atenuados de $k/2$, deslocados de $\pm T$ e atrrasados de $t_d$, como mostrado na Figura~\ref{fig:pulsosatrasados}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/pulsosatrasados.eps,width=12cm}}
\caption{\label{fig:pulsosatrasados}Pulsos deslocados no tempo e atenuados.}
\end{figure}
%*******************


A dispersão é causada pelos ecos em $\pm T$.
Magnitude ideal e fase não ideal de $H(\omega)$ provoca um efeito similar.
\end{exemplo}

\begin{exercicio} O que aconteceria com o sinal na saída do canal do exemplo anterior se o sinal de entrada não fosse limitado a $B$Hz?
\end{exercicio}

\subsection{Equalização}

Em tese pode-se eliminar a distorção linear no receptor pela aplicação de um função de seja inversa a do canal. Esse processo é conhecido como equalização. Sendo $H_C(\omega)$ a resposta ao impulso do canal e $H_{eq}(\omega)$ a resposta ao impulso do equalizador se fizermos
\[
 H_C(\omega)H_{eq}(\omega) = Ke^{-j\omega t_d}
\]
sendo $k$ e $t_d$ constantes tem-se o sinal recebido sem distorção.

Um exemplo simples de equalizador são os filtros transversais, como estão mostrados na Figura~\ref{fig:filtrotransversal}. Nesse filtro o sinal recebido $s(t)$ passa por uma linha que o atrasa e multiplica cada atraso por um coeficiente $c_i$, dessa forma
\[
 r(t) = c_{-1}x(t) + c_0 x(t-\Delta) + c_1(t - 2\Delta)
\]
e
\begin{eqnarray}
 H_{eq} &=& c{-1} + c_0e^{-j\omega\Delta} + c_1 e{-j\omega 2\Delta} \nonumber \\
&=& (c{-1}e^{j\omega\Delta} + c_0 + c_1 e{-j\omega Delta})e^{-j\omega\Delta}.
\end{eqnarray}
Que pode ser generalizada para um conjunto de $2M+1$ atrasos por
\[
 H_{eq}(\omega) = \left(\sum_{m=-M}^{m=M}c_me^{-j\omega m\Delta}\right)e^{-j\omega M\Delta}
\]
a série de Fourier exponencial com período $1/\Delta$.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=/home/ecandeia/Figuras/filtrotransversal.eps,width=8cm}}
\caption{\label{fig:filtrotransversal}Filtro transversal usado como equalizador.}
\end{figure}
%*******************

\subsection{Distorção Causada pelas não linearidades do canal}

Para pequenos sinais é válido aproximar um canal qualquer por um canal linear, mas para
amplitudes maiores
as não linearidades não podem ser ignoradas.

Vamos considerar um caso simples de um canal não linear sem memória, no qual
$y(t)$ está relacionada com a saída por uma equação não linear $y=f(x)$.
Usando a série de McLaurin para expandir $f(x)$
\[
r = a_0 + a_1 x(t) + a_2 x(t)^2 + ... + a_k x(t)^k + ...
\]
A série de potências nos permite avaliar o espectro resultante
\[
x^{k}(t) \leftrightarrow \left(\frac{1}{2\pi}\right)^{k-1}X(\omega) * X(\omega) ...*X(\omega)
\]
donde
\[
Y(\omega) = 2\pi a_0\delta(\omega) + \sum_{k}\frac{a_k}{(2\pi)^{k-1}}X(\omega)*X(\omega)
...*X(\omega)
\]

Podemos tirar algumas conclusões da equação acima: uma delas é que a saída consiste dos espectro
de entrada mais repetidas autoconvoluções desse mesmo espectro.

Quando um espectro é convoluído com ele mesmo o espectro resultante tem largura de banda duas vezes
maior que o original. Assim, $(k-1)$ autoconvoluções vai aumentar a largura de faixa por
um fator $k$.
Isto significa que o sinal de saída terá componentes de frequência que não
existiam no sinal original.
Este tipo de distorção causa não apenas distorção no sinal mas interferência nos
canais vizinhos.% FDM. Sistemas TDM não são afetados por essa interferência.

\begin{exemplo} Um sinal em banda básica $m(t)$ modulado em AM-DSB-DC numa portadora de
frequência $\omega_c$. O sinal modulado é transmitido através um canal com a
seguinte característica
\[
y = a_1 x(t)+ a_2 x^2(t) + a_3 x^3(t)
\]
sendo $x$ a entrada e $y$ a saída. Detemine o sinal recebido, desenhe  o espectro
e comente o resultado obtido.
\end{exemplo}

Sendo
\[
x(t) = m(t)\cos\omega_c t
\]
então
\[
y(t) = a_1 m(t)\cos\omega_c t + a_2m^{2}(t)\cos^{2}\omega_c t + a_3m^{3}(t)\cos^{3}\omega_c t
\]
sabemos que $cos^2\theta = \frac{1}{2}(1+\cos 2\theta)$ e
$\cos^{3}\theta = \frac{1}{4}(3\cos\theta + cos 3\theta)$,
assim
\begin{eqnarray}
y(t) &=& a_1 m(t)\cos\omega_c t + \frac{a_2}{2}m^{2}(t) + \frac{a_2}{2}m^{2}(t)\cos 2\omega_c t
+ 3\frac{a_3}{4}m^{3}(t)\cos\omega_c t + \frac{a_3}{4}m^{3}\cos 3\omega_c t \nonumber \\
&=& \frac{a_2}{2}m^{2}(t) + [a_1m(t) + \frac{3}{4}a_3 m^{3}(t)]\cos\omega_c t +
\frac{a_2}{2}m^{2}(t)\cos\omega_c t + \frac{a_3}{4}m^{3}\cos 3\omega_c t.
\end{eqnarray}


%FIGURA

Usando um filtro passa faixa centrado em $\omega_c$ de largura $4\pi B$ então
\[
y_{filtrado}(t) = [a_1 m(t) + \frac{3}{4}a_3m^{3}(t)]\cos\omega_c t
\]
no qual a primeira componente é o sinal desejado e a segunda componente a distorção. Observe que o sinal de saída $y(t)$ provavelmente vai interferir em outros canais.

\subsubsection{Compansão}

O efeito das não linearidades pode ser reduzido para este tipo de canal usando um
dispositivo que é o recíproco do canal.

Em alguns casos um sinal é intencionalmente distorcido passando por um compressor
na transmissão e por um expansor na recepção.

O compressor amplifica mais os sinais em níveis baixos do que em níveis altos e em geral segue uma curva logarítmica, o expansor implementa a função inversa.
Compressão-expansão$\Rightarrow$ compansão.

\subsection{Distorção causada pelo efeito do multipercurso}

Recepção em multipercurso ocorre quando um sinal transmitido chega no receptor
por diferentes percursos com atrasos diferentes, isso ocorre em enlaces de
rádio, cabos não casados, dentre outros meios de transmissão.

O canal pode ser representado então por vários canais em paralelo, cada um com uma
atenuação e atraso próprios.
Vamos considerar um caso com apenas dois percursos, um com ganho 1 e atraso $t_d$ e
outro com ganho $\alpha$ e atraso $t_d +\Delta t$, como está representado na Figura~\ref{fig:canalmultipercurso}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/canalmultipercurso.eps,width=12cm}}
\caption{\label{fig:canalmultipercurso} Canal com dois percursos.}
\end{figure}
%*******************

As funções de transferência para cada caminho são respectivamente
\[
H_1(\omega) = e^{-j\omega t_d}
\]
e
\[
H_2(\omega) = \alpha e^{-j\omega(t+\Delta t)},
\]
donde se obtém
\begin{eqnarray}
H(\omega) &=& H_1(\omega) + H_2(\omega) \nonumber \\
&=& e^{-j\omega t_d} + \alpha e^{-j\omega(t_d + \Delta t)} \nonumber \\
&=& e^{-j\omega t_d}(1+\alpha e^{-j\omega \Delta t}) \nonumber \\
&=& e^{-j\omega t_d}(1 +\alpha\cos\omega \Delta t -j\sin\omega\Delta t)
\end{eqnarray}

\begin{eqnarray}
\mid H(\omega)\mid &=& \sqrt{(1+\alpha\cos\omega\Delta t)^{2} + \alpha^{2}\sin^{2}\omega\Delta t} \nonumber \\
&=& \sqrt{1 + 2\alpha\cos\omega\Delta t + \alpha^2\cos^2\omega\Delta t + \alpha\sin^2\omega\Delta t} \nonumber \\
&=& \sqrt{1 + \alpha^2 + 2\alpha\cos\omega\Delta t}
\end{eqnarray}

\begin{eqnarray}
\theta_h(\omega) = -(\omega t_d + tan^{-1}\frac{\alpha\sin\omega\Delta t}{1 + \alpha\cos\omega\Delta t})
\end{eqnarray}

Pode-se observar na Figura~\ref{fig:homegamultipercurso} que a maginitude e a fase de $H(\omega)$ tem perído $2\pi/\Delta t$.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/homegamultipercurso.eps,width=9cm}}
\caption{\label{fig:homegamultipercurso} Magnitude e fase da função de transferência de um canal com dois percursos.}
\end{figure}
%*******************

Multipercurso causa distorção linear e portanto dispersão. Esta distorção pode ser parcialmente
corrigida pelo uso de equalizadores.

\begin{exercicio}
 Considere um canal no qual o sinal enviado chega ao receptor por dois caminhos distintos. O primeiro atenua o sinal por um fato $k_1$ e atrasa de $t_1$, o segundo tem atenuação $k_2$  e atraso $t_2$. Obtenha a expressão de um equalizador baseado em uma linha de atraso para esse canal.
\end{exercicio}


\subsubsection{Canais com desvanecimento}

Até agora assumimos o canal invariante no tempo. Na prática
encontramos canais cujas características de transmissão variam com o
tempo. Como exemplo, os canais de tropodifusão que usam a ionosfera
para reflexão de rádio a longa distância. Nesses canais as variações 
ocorrem por causa das condições meterológicas.

Portanto, a função de transferência do canal varia de forma aleatória produzindo uma variação aleatória no sinal. Este fenômeno é conhecido como desvanecimento (em inglês {\em fading}).

O desvanecimento pode ser fortemente dependente da frequência, ou seja afeta mais determinadas componentes de frequências. Isto é chamado de desvanecimento seletivo. 

\subsection{A Largura de Faixa e a taxa de transmissão dos pulsos}

Na comunicação digital os dados são transmitidos na forma de pulsos. A informação não segue na forma do pulso mas no ``tamanho'' relativo desses pulsos. Assim o receptor não está interessado no formato do pulso, mas no tamanho relativo deles.

Pulsos são detectados tomando uma amostra no seu valor de pico, o
valor obtido é usado para decidir qual pulso foi emitido. Pulsos
limitados no tempo tem largura de faixa infinita. Em geral o canal é limitado em faixa,  isto implica que o pulso é espalhado no tempo causando dispersão. Por exemplo, seja o pulso $p(t)$ da Figura~\ref{fig:pulsoespalhado}, após passar pelo canal tem-se o pulso $p^{\prime}(t)$.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/pulsoespalhado.eps,width=12cm}}
\caption{\label{fig:pulsoespalhado} Pulso $p(t)$ enviado e $p^{\prime}(t)$ recebido.}
\end{figure}
%*******************

Se a dispersão interferir no pulso vizinho isto pode causar erros. Portanto os pulsos devem estar espaçados o suficiente para diminuir a interferência.

Quanto menor a largura de faixa do canal, mais espalhado será o pulso, mais afastado ele deve estar do vizinho, o que diminui a taxa de transmissão. Concluimos então que a taxa de transmissão é limitada pela largura de faixa do canal.


\subsection{Filtros Ideais}

Filtros ideais permitem transmissão sem distorção de uma certa faixa de frequências
e comprime todos as outras. Ne Figura~\ref{fig:filtroidealpassabaixa} tem-se o módulo e a fase de um filtro passa-baixas ideal.
As frequências abaixo $2\pi B$ passam sem distorção e todas as componentes acima de $2\pi B$
são suprimidas.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/filtropassabaixasideal.eps,width=6cm}}
\caption{\label{fig:filtroidealpassabaixa}Módulo e fase do espectro de um filtro ideal passa baixas.}
\end{figure}
%*******************

Pode-se ainda ter um filtro ideal passa altas, representado na Figura~\ref{fig:filtropassaaltasideal} ou
um filtro passa faixa ideal, representado na Figura~\ref{fig:filtropassafaixaideal}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/filtropassaaltasideal.eps,width=6cm}}
\caption{\label{fig:filtropassaaltasideal}Módulo e fase do espectro de um filtro ideal passa altas.}
\end{figure}
%*******************

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/filtropassafaixaideal.eps,width=6cm}}
\caption{\label{fig:filtropassafaixaideal}Módulo e fase do espectro de um filtro ideal passa faixa.}
\end{figure}
%*******************

A função $h(t)$ para o filtro passa baixas ideal, também chamada resposta a um
impulso unitário, é dada por $h(t) = \mathcal{F}^{-1}[H(\omega)]$
\[
H(\omega) = \Pi\left(\frac{\omega}{4\pi B}\right)e^{-j\omega t_d}
\]
sendo
\[
\Pi\left(\frac{\omega}{4\pi B}\right) =
\left\{
\begin{array}{c c}
1 & \mid\omega\mid < 4\pi B/2 \\
0 & \mid\omega\mid > 4\pi B/2
\end{array}
\right.
\]
logo $h(t) = 2BSinc[2B(t-t_d)]$, representada na Figura~\ref{fig:passabaixasidealtempo}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/passabaixasidealtempo.eps,width=6cm}}
\caption{\label{fig:passabaixasidealtempo}Filtro passa baixas ideal no domínio do tempo.}
\end{figure}
%*******************


Pelo resultado acima tem-se que $h(t)$ existe para $t<0$. Isto é um
resultado bastante estranho considerando que $h(t)$ é a resposta a
um impulso aplicado em $t=0$, ou seja, a resposta aparece antes
da entrada ser aplicada.

Infelizmente nenhum sistema real exibe essa característica profética (de prever
que uma determinada excitação vai ocorrer). Donde concluí-se que um filtro ideal
apesar de ser desejável não é fisicamente realizável.

De forma similar podemos mostrar que outros filtros ideias são fisicamente irrealizáveis
Para um sistema ser fisicamente realizável $h(t)$ deve ser causal, isto é,
$h(t)=0$ para $t<0$.

A função $h(t)$ do filtro ideal pode não ser realizável mas
$\hat{h} = h(t)u(t)$ é fisicamente realizável porque é causal. Tal filtro
no entanto não é ideal e distorce o sinal limitado em BHz.

Mas se aumentarmos a atraso $t_d$ (teoricamente se $t_d\rightarrow \infty$) teríamos um
filtro ideal ``realizável''. $\hat{h}(t)$ pode ser uma réplica
aproximada de $h(t)$ exceto pelo atraso. O filtro resultante $\hat{H}(\omega)$
é uma aproximação de $H(\omega)$.

Assim um filtro ideal pode ser realizado de um modo aproximado com um certo atraso $t_d$.
Se $t_d$ for da ordem de 2 ou 3 vezes $1/2B$ fará com que $\hat{h}(t)$ seja uma versão
razoavelmente aproximada de $h(t)$.

Fazendo uma analogia, se uma pessoa quiser saber o que vai acontecer daqui a um ano (com
a universidade por exemplo), ela tem duas opções
\begin{enumerate}
\item ir a um vidente (uma pessoa irrealizável) que pode dar a
  resposta imediatamente, ou
\item consultar um {\em expert} e permitir que ele lhe dê a notícia daqui a um ano.
Mas se o {\em expert} for mesmo sábio ele pode acertar o prognóstico com atraso menor
que um ano, verificando as tendências.
\end{enumerate}

Na prática temos uma variedade de filtros, por exemplo, os filtros Butterworth são
descritos pelas funções de transferência
\[
\mid H(\omega)\mid = \frac{1}{\sqrt{1+\left(\frac{\omega}{2\pi B}\right)^{2n}}}
\]
sendo $n$ a ordem do filtro. Na Figura~\ref{fig:filtrobutterwolf}
temos filtros para alguns valores de $n$.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/filtrobutterwolf.eps,width=9cm}}
\caption{\label{fig:filtrobutterwolf}Filtro Butterwolf para alguns valores de $n$.}
\end{figure}
%*******************

Deve ser lembrado que $\mid H(\omega)|$ e a fase $\theta_h(\omega)$ são interdependentes e ao escolher um valor de $n$ para um filtro pode ser que o módulo se aproxime do valor ideal, mas a fase se afaste do valor ideal.

\subsection{Filtros Digitais}

Sinais analógicos também podem ser processados por meios digitais (conversão A/D), seguindo o esquema
representado na Figura~\ref{fig:dsp}. O
sinal resultante pode então ser processado por um computador dedicado, projetado para
converter a entrada na saída desejada. Esses computadores são chamados de Processadores Digitais de Sinais (DSP, do inglês, {\em Digital Signal Processor}).

A saída é então convertida (D/A) para forma analógica. Um algoritmo especial do
processador e usado para conseguir a operação deseja (filtragem PB, PG, PA).


%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/dsp.eps,width=12cm}}
\caption{\label{fig:dsp}Esquema de um DSP.}
\end{figure}
%*******************

As vantagens do processamento digital são:
\begin{itemize}
\item pode ser compartilhado para várias utilizadores;
\item em geral o custo é consideravelmente mais baixo;
\item a precisão dos filtros digitais é dependente apenas do tamanho
da palavra processada, dos intervalos de quantização e da taxa de
amostragem;
\item emprega elementos simples (somadores, multiplicadores, etc.)
em vez de RLC e amplificadores operacionais. O resultado disso
é que os filtros digitais não são afetados por precisão de componentes, temperatura,
envelhecimento, etc;
\item filtros de mais alta ordem são facilemente realizáveis;
\item podem ser facilemente modificados, alterando-se apenas o algoritmo.
\end{itemize}

\subsubsection{Exemplo: Filtros Digitais de Reposta Finita}

Os filtros diigtais de resposta finita ao impulso (FIR, do inglês {\em Finite Impulse Response}) 
produzem uma saída, $y[n]$, que é uma soma ponderada das entradas atuais e passadas, $x[n]$, ou seja:
\[
y[n] = b_0x[n] + b_1x[n-1] + b_2x[n-2] + .... + b_qx[n-q]
\]
ou
\[
 y[n] = \sum_{i=0}^{q}b_ix[n-i]
\]
sendo $b_i$, $i=0,...,q$ os coeficientes que determinam o tipo do filtro.

Dado o comportamento esperado de um filtro em freqüência, $H(\omega)$, pode-se calcular a transformada de 
Fourier inversa e assim determinar os coeficiente do filtro $(b_i)$ para que ele tenha o comportamento
desejado. Como exemplo considere um filtro passa-baixas dado por
\begin{equation}
H(\omega) =
\left\{
\begin{array}{c c}
 1 & \omega \leq \omega_c \\
0 & c.c.
\end{array}
\right.
\label{eq:filtropassabaixa}
\end{equation}
pode-se calcular
\[
b_n = \frac{1}{2\pi}\int_{-\infty}^{\infty} H(\omega)e^{jn\omega}d\omega = \frac{1}{2\pi}\int_{-\omega_c}^{\omega_c} e^{jn\omega}d\omega = \frac{1}{2\pi} \left[\frac{1}{jn}e^{jn\omega}\right]_{-\omega_c}^{\omega_c} = \frac{\sin(n\omega_c)}{\pi n}
\]

Do resultado acima nota-se que para obter um filto passa baixas com a resposta em frequência da Equação~\ref{eq:filtropassabaixa} (filtro passa baixas ideal) é necessário usar uma quantidade infinita de coeficientes, logo enforça-se que filtros dessa natureza são irrealizáveis.
Apesar da implementação do filtro ideal com o uso de todos os coeficientes ser impossível, pode-se truncar a quantidade de coeficientes utilizado e obter uma aproximação do filtro ideal. 

\section{Densidade Espectral de Energia}

A energia de um sinal $g(t)$ é definida como a área sob $\mid g(t)\mid^2$. Esse
parâmetro também pode ser obtido da transformada de Fourier de $g(t)$, usando
o Teorema de Parseval mostrado a seguir.

        \begin{teorema}[Teorema de Parseval] Seja
        \[E_g = \int_{-\infty}^{\infty}\mid g(t)\mid^{2}dt
        \]
        a energia a sinal $g(t)$ e caso essa função seja complexa tem-se $\mid g(t)\mid^2 =
        g(t)g^{*}(t)$, então
\begin{eqnarray}
E_g &=& \int_{-\infty}^{\infty}g(t)g^{*}(t)dt \\
    &=& \int_{-\infty}^{\infty}g(t)\left[\frac{1}{2\pi}\int_{-\infty}^{\infty}
        G^{*}(\omega)e^{-j\omega t}d\omega\right]dt
\end{eqnarray}
        trocando a odem das integrais tem-se:
\begin{eqnarray}
E_g &=& \frac{1}{2\pi}\int_{-\infty}^{\infty}G^{*}(\omega)\left[
    \int_{-\infty}^{\infty}g(t)e^{-j\omega t}dt d\omega\right] \\
    &=& \frac{1}{2\pi}\int_{-\infty}^{\infty}G(\omega)G^{*}(\omega)d\omega \\
E_g &=& \frac{1}{2\pi}\int_{-\infty}^{\infty}\mid G(\omega)\mid^{2}d\omega
\end{eqnarray}
\end{teorema}

A fuunção $\mid G(\omega)\mid$ é chamada de {\bf Densidade espectral de energia} (ESD).
Agora pode-se determinar a energia de um sinal tanto pela sua representação no
tempo quanto pela representação na frequência.

\begin{exemplo} Seja $g(t) = e^{-at}u(t)$ $a>0$,  determinar a energia de $g(t)$.
\begin{eqnarray}
E_g &=& \int_{-\infty}^{\infty}\mid g(t)\mid^{2}dt \nonumber \\
    &=& \int_{0}^{\infty} e^{-2at}dt = -\frac{1}{2a}e^{-2at}\mid_{0}^{\infty} \nonumber \\
E_g &=& \frac{1}{2a} \nonumber
\end{eqnarray}
Agora, seja a transformada de Fourier de $g(t)$ dada por $G(\omega) = \frac{1}{j\omega +a}$
então
\begin{eqnarray}
        E_g &=& \frac{1}{2\pi}\int_{-\infty}^{\infty}\mid
        G(\omega)\mid^{2}d\omega \nonumber \\
        &=& \frac{1}{2\pi}\int_{-\infty}^{\infty}\frac{1}{a^2 +
          \omega^2}d\omega \nonumber \\
        &=& \frac{1}{2\pi
          a}\tan^{-1}\frac{\omega}{a}\mid_{'\infty}^{\infty} \nonumber
        \\
        Eg&=& \frac{1}{2a} \nonumber
\end{eqnarray}
\end{exemplo}

Da equação
\[
   E_g = \frac{1}{2\pi}\int_{-\infty}^{\infty}\mid G(\omega)\mid^{2}d\omega
        \]
        pode-se observar que a contrbuição de frequência $\omega$ para a energia de $g(t)$
        é igual a $\mid G(\omega)\mid^{2}$. Então, considere $g(t)$ aplicado como
        entrada do filtro passa-faixa $H(\omega)$ entrado em $\omega_0$, representado
        na Figura~\ref{fig:filtropfideal}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/filtropfideal.eps,width=8cm}}
\caption{\label{fig:filtropfideal}Filtro passa faixa ideal centrado em $\omega_0$.}
\end{figure}
%*******************

A saída do filtro $Y(\omega)$ será dada por $Y(\omega) = G(\omega)H(\omega)$
e a energia de $y(t)$ por
 \[
        E_y = \frac{1}{2\pi}\int_{-\infty}^{\infty}\mid G(\omega)H(\omega)\mid^{2}d\omega
        \]
        como $H(\omega)=1$ no entorno de $\omega_0$ tem-se
        \begin{eqnarray}
        E_y &=& 2\frac{1}{2\pi}\int_{\omega_0 - \Delta\omega_0}^{\omega_0 + \Delta_{\omega_0}}
        \mid G(\omega)\mid\omega \\
        &=& \frac{1}{\pi}\mid G(\omega_0)\mid^{2}df
        \end{eqnarray}
        então $\mid G(\omega)\mid^2 df$ é a contribuição a energia de $g(t)$ pelas bandas
        $\Delta f$ centradas em $\omega_0$, logo $\mid G(\omega)\mid^2$ é a energia
        por unidade de largura de banda (Hertz) da componente espectral de $g(t)$
        centrada em $\omega$, ou $\mid G(\omega)\mid^2$ é {\bf Densidade Espectral de
        Energia} de $g(t)$, ou seja
\[
\Phi_g(\omega) = \mid G(\omega)\mid^2 \ \ e\ \ E_g = \frac{1}{2\pi}\int_{-\infty}^{\infty}
        \Phi_g(\omega)d\omega
        \]

\subsection{Função de autocorrelação no tempo e densidade espectral de energia}

Vamos mostrar que a ESD é a transformada de Fourier da função de autocorrelação no tempo. Para isso, definimos a 
autocorrelação no tempo de um sinal $g(t)$ como
\[
\psi_g(\tau) = \int_{-\infty}^{\infty}g(t)g(t+\tau)dt.
\]
Primeiro vamos mostrar que $\psi(\tau)$ é par quando $g(t)$ é real, para isso tomemos $x = t+\tau$, ou, $t = x - \tau$ e $dt = dx$, assim
\begin{eqnarray}
\psi_g(\tau) &=& \int_{-\infty}^{\infty}g(x-\tau)g(x)dx \nonumber \\
&=& \int_{-\infty}^{\infty}g(x)g(x-\tau)dx = \psi(-\tau).
\end{eqnarray}

Para provarmos que $\mathcal{F}[\psi_g(\tau)] = \Psi_g(\omega)$ vamos mostrar que
\[
\psi_g(\tau) = g(\tau)*g(-\tau)
\]
para isso vamos fazer $g(-\tau) = f(\tau)$ assim
\[
g(\tau)*g(-\tau) = g(\tau)*f(\tau) = \int_{-\infty}^{\infty}g(x)f(\tau - x)dx
\]
\[
f(\tau - x) = g[-(\tau - x)] = g(x-\tau)
\]
assim
\[
g(\tau)*g(-\tau) = \int_{-\infty}^{\infty}g(x)g(x-\tau)dx = \psi_g(-\tau) = \psi_g(\tau)
\]
para $g(t)$ real
\[
g(\tau) \leftrightarrow G(\omega)
\]
\[
g(-\tau) \leftrightarrow G(-\omega) = G^{*}(\omega)
\]
e portanto
\[
g(\tau)*g(-\tau) \leftrightarrow G(\omega)*G^{*}(\omega) = \mid G(\omega)\mid ^{2} = \Psi_g(\omega)
\]


\subsection{Estimativa da Largura de Faixa Essencial de um Sinal}

Para amostrarmos um sinal temos que conhecer sua largura de faixa. Todos os sinais práticos são limitados
no tempo, portanto não são limitados em faixa.

Como os sinais limitados no tempo tem energia finita, o espectro de todos os sinais práticos devem decair 
com a frequência. Assim, além de uma determinada frequência a contribuição espectral para a energia do sinal
pode ser considerada desprezível.

Portanto para uma dada aplicação podedmos estabelecer um critério de erro no qual consideramos o sinal 
limitado em $B Hz$. Por exemplo, podemos usar o critério de que um sinal é limitado em $B Hz$ se a 
contribuição das componentes espectrais acima de $B Hz$ for menor que $x$ porcento da energia do sinal.
Quanto menor o valor de $x$, menor o erro sobreposição ({\em aliasing}).

\subsubsection{Densidades de Energia de Entrada e Saída}

Seja $g(t)$ o sinal de entrada e $y(t)$ o sinal de saída de um sistema linear com função de
transferência $H(\omega)$, ou seja, $Y(\omega) = X(\omega)H(\omega)$, então temos
\begin{eqnarray}
\Psi_y(\omega) &=& \mid Y(\omega)\mid^2 = \mid G(\omega)H(\omega)\mid^2 = \mid H(\omega)\mid^2 \mid(G(\omega)\mid^2 \nonumber \\
&=& \mid H(\omega)\mid^2 \Psi_g(\omega)
\end{eqnarray}


\section{Densidade Espectral de Potência}

       Se um sinal $g(t)$ existe para $-\infty < t < \infty$ define-se a potência média,
        ou simplesmente potência, $P_g$ desse sinal como a potência média dissipada por
        um resistor de $1\Omega$ quando uma tensão $g(t)$ é aplicada sobre ele. Assim
        \begin{equation}
        P_g = \lim_{T\rightarrow\infty}\frac{1}{T}\int_{-T/2}^{T/2}g^{2}(t)dt
        \end{equation}

A potência assim definida é simplesmente o valor médio quadrático de $g(t)$ ou
\[
        P_g = \overline{g^{2}(t)}
        \]

        Observe que se $E_g$ é finita, então $P_g=0$ e se $P_g$ é finita $E_g$ é infinita.
        Dessa forma tem-se a seguinte classificação:
        \begin{itemize}
        \item sinais com $E_g$ finita são denominados de energia;
        \item sinais com $P_g$ finita e diferente de zero são chamados sinais de potência.
        \end{itemize}

        Alguns sinais não obedececm essa classificação, por exemplo o sinal $g(t) = e^{-at}$
        $-\infty < t < \infty$ tem $E_g$ e $P_g$ infinitas.

Para achar $P_g$ no domínio de frequência como $E_g\rightarrow\infty$ para
sinais de potência, existe a possibilidade de não existir a transformada de
Fourier. Portanto vamos considerar $g(t)$ truncado
\begin{equation}
g_{T}(t) = \left\{
\begin{array}{c c}
g(t) & |T| < T/2 \\
0    & |T| > T/2
\end{array}
\right.
\end{equation}

     Enquanto $T$ for finito, $E_g$ é finita e existe a transformada de Fourier
     $g_T(t) \leftrightarrow G_T(\omega)$ e
        \begin{equation}
        E_T = \int_{-\infty}^{\infty}g_{T}^{2}(t)dt = \frac{1}{2\pi}\int_{-\infty}^{\infty}
        \mid G_{T}(\omega)\mid^{2}d\omega
        \end{equation}
        mas
        \[
        \int_{-\infty}^{\infty}g_{T}^{2}(t)dt = \int_{-T/2}^{T/2}g^{2}(t)dt
        \]
        donde
       \begin{equation}
        P_g = \lim_{T\rightarrow\infty}\frac{1}{T}\int_{-T/2}^{T/2}g^{2}(t)dt = \lim_{T\rightarrow\infty}\frac{1}{T}=\lim_{T\rightarrow\infty}\frac{1}{T}\left[\frac{1}{2\pi}\int_{-\infty}^{\infty}\mid G_{T}(\omega)\mid^{2}d\omega\right]
        \end{equation}

       Quando $T$ aumenta, também aumentam $E_T$ e $\mid G_T(\omega)\mid^2$, no entanto
        $\frac{\mid G_T(\omega)\mid^2}{T}$ se aproxima de algum limite quando $T\rightarrow\infty$,
        pois crescem com a mesma taxa, assim tem-se:
        \begin{equation}
        P_g = \frac{1}{2\pi}\int_{-\infty}^{\infty}\lim_{T\rightarrow\infty}\frac{\mid G(\omega\mid^2}{T}d\omega
        \end{equation}
        e define-se a Densidade Espectral de Potência (DEP) como
        \begin{equation}
        \label{eqDEP}
        S_g(\omega) = \lim_{T\rightarrow\infty}\frac{\mid G(\omega)\mid^2}{T}
        \end{equation}
        donde
        \begin{equation}
        P_g = \frac{1}{2\pi}\int_{-\infty}^{\infty}S_g(\omega)d\omega = \frac{1}{\pi}\int_{0}^{\infty}S_g(\omega)d\omega
        \end{equation}
        a mudança no limite inferior de integração na equação acima deve-se ao fato que $S_g(\omega)$
        é positiva, real e par. A unidade de $S_g$ é $W/Hz$ e a de $P_g$ é $W$.

Usando a variável $f$ ao invé de $\omega$ tem-se
\begin{equation}
P_g = \int_{-\infty}^{\infty}S_g(2\pi f)df = 2\int_{0}^{\infty}S_g(2\pi f)df
\end{equation}

De $S_g(\omega) = \lim_{T\rightarrow\infty}\frac{\mid G(\omega)\mid^2}{T}$ deduz-se que
a DEP de um sinal contém apenas informação de magnitude do espectro de frequências
de $G_T(\omega)$ e perde a informação de fase. Isto quer dizer que alterar a fase não
altera a DEP.

        \section{Correlação no Tempo de Sinais de Potência}

A função de autocorrelação no tempo $R_g(\tau)$ de um sinal $g(t)$ é definida como
\begin{equation}
\label{eqAUT}
R_g(\tau) = \overline{g(t)g(t+\tau)} = \lim_{T\rightarrow\infty}\frac{1}{T}\int_{-T/2}^{T/2}
g(t)g(t+\tau)dt
\end{equation}

        trocando $t+\tau$ por $x$ tem-se
        \begin{equation}
        R_g(\tau) = \overline{g(x-\tau)g(x)} = \lim_{T\rightarrow\infty}\frac{1}{T}\int_{-T/2+\tau}^{T/2+\tau}
        g(x-\tau)g(x)dt
        \end{equation}
        como $x$ é uma variável muda pode-se fazer $x=t$ e obtém-se:
        \begin{equation}
        R_g(\tau) = \overline{g(t)g(t-\tau)} = R_g(-\tau)
        \end{equation}
        ou seja $R_g(\tau)$ é uma função par.

Como no caso dos sinais de energia
\begin{equation}
\mathcal{F}[R_g(\tau)] = S_g(\omega)
\end{equation}
tomemos novamente $g_T(t)$ e sua densidade espectal de energia $\mid G_T(\omega)\mid^2$, então
\begin{equation}
        R_g(\tau) = \lim_{T\rightarrow\infty}g_T(\tau)g_T(t+\tau)dt = \lim_{T\rightarrow\infty}\frac{\psi_{g_T}(\tau)}{T}
        \end{equation}
        e
       \begin{equation}
        F[R_g(\tau)] = \lim_{T\rightarrow\infty}\frac{F[\psi_{g_T}(\tau)]}{T}  = \lim_{T\rightarrow\infty}\frac{\mid G_T(\omega)\mid^2}{T} = S_g(\omega)
        \end{equation}

        Fazendo $\tau = 0$ na Equação~\ref{eqAUT} tem-se
        \begin{equation}
        R_g(0) = \overline{g^2(t)} = P_g
        \end{equation}

\begin{exemplo} Determinar a DEP de $g(t)=A\cos(\omega_{0}t+\theta)$.
\end{exemplo}

\subsubsection{Solução:} 

Usando a função de autocorrelação tem-se
\begin{eqnarray}
R_g(\tau)&=&\lim_{T\rightarrow\infty}\frac{1}{T}\int_{-T/2}^{T/2}A\cos(\omega_{0}t + \theta)A\cos(\omega_{0}(t+\tau)+\theta)dt \nonumber \\
&=&\lim_{T\rightarrow\infty}\frac{A^2}{2T}\left[\int_{-T/2}^{T/2}A\cos(\omega_{0}\tau)dt + \int_{-T/2}^{T/2}\cos(2\omega_{0}t + \omega_{0}\tau + 2\theta)\right]dt
\nonumber \\
&=& \frac{A^2}{2}\cos\omega\tau\lim_{T\rightarrow\infty}\frac{T}{T} \nonumber \\
&=& \frac{A^2}{2}\cos\omega\tau
\end{eqnarray}
donde pode-se observar que $R_g(\tau)$ é independente de $\theta$, a fase de $g(t)$. A PSD será
\begin{eqnarray}
S_g(\omega) &=& \mathcal{F}[R_g(\tau)] = \frac{A^2}{2}\mathcal{F}[\cos\omega\tau] \nonumber \\
&=& \pi\frac{A^2}{2}[\delta(\omega - \omega_0) + \delta(\omega+\omega_0)]
\end{eqnarray}

A potência média, ou valor médio quadrático de $g(t)$ será
\[
P_g = R_g(0)=\frac{A^2}{2}
\]
ou de outra forma
\begin{eqnarray}
P_g &=& 2\int_{0}^{\infty}S_g(\omega)df = 2\int_{0}^{\infty}\frac{\pi A^2}{2}\delta(\omega - \omega_0)df \nonumber \\
&=& \frac{A^2}{2}
\end{eqnarray}
confirmando um fato bastante conhecido.

\subsection{PSD de sinais modulados}

Modulação provoca um deslocamento na PSD de um sinal banda básica. Se $g(t)$ é um sinal de potência
limitado em $B Hz$ então o componente sinal modulado
\[
\psi(t) = g(t)\cos\omega_0 t
\]
então
\[
S_{\psi}(\omega) = \frac{1}{4}[S_g(\omega - \omega_0) + S_g(\omega + \omega_0)]
\]
quando $\omega_0 \geq 2\pi B$.

De maneira similar como foi feito para sinais de energia
\[
P_{\psi} = \overline{[g(t)\cos\omega_0 t]^2} = \frac{1}{2}\overline{g^{2}(t)} \text{ quando } \omega_0\geq 2\pi B = \frac{1}{2}P_g
\]
e
\[
R_{\psi}(\tau) = \mathcal{F}^{-1}[s_{\psi}(\omega)] = \mathcal{F}^{-1}[\frac{1}{4}\S_{g}(\omega - \omega_0) +S_g(\omega+\omega_0)]
\]
pela propriedade da modulação
\[
g(t)\cos\omega_0 t \leftrightarrow \frac{1}{2}[G(\omega-\omega_0)+G(\omega-\omega_0)]
\]
logo
\[
R_{\psi}(\tau)=\frac{1}{4}2R_{g}(\tau)\cos\omega_0\tau = \frac{1}{2}R_{g}(\tau)\cos\omega_{0}\tau
\]
e
\[
P_{\psi}=R_{\psi}(0)=\frac{1}{2}R_g(0)=\frac{1}{2}P_g
\]


\subsection{Relação ente a DSP de entrada com DSP de saída}

Idêntico ao caso anterior para sinais de energia, se $H(\omega)$ é a função de transferência de um sistema linear
e invariante no tempo, então
\[
S_y(\omega) = \mid H(\omega)\mid^2 S_g(\omega)
\]
e
\[
R_y(\tau) = h(\tau)*h(-\tau)*R_g(\tau)
\]

\subsection{Interpretação da DSP}

Também similar a interpretação feita para a densidadee espectral de
energia, a densidade espectral de potência representa a contribuição
de potência de várias componentes de frequência. $S_g(\omega)$
representa a potência por unidade de largura de faixa das componentes de frequência
centradas em $\omega$.

\begin{exemplo} \label{ex:psdconstante}Um sinal $g(t)$ tem PSD $S_g(\omega)=\mathcal{N}/A^2$ como mostrado na Figura~\ref{fig:psdconstante}.
Determine a PSD e o valor médio quadrático de sua derivada.
\end{exemplo}

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/psdconstante.eps,width=8cm}}
\caption{\label{fig:psdconstante} PSD do sinal $g(t)$ do Exemplo~\ref{ex:psdconstante}.}
\end{figure}
%*******************

\subsubsection{Solução}

Podemos observar a derivada como um sistema cuja entrada é o sinal
$g(t)$, a função de transferência é a derivada e a
saída o sinal derivado, como está representado na Figura~\ref{fig:sistemaderivada}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/sistemaderivada.eps,width=5cm}}
\caption{\label{fig:sistemaderivada} Derivada vista como um sistema.}
\end{figure}
%*******************

Assim, como $S_y(\omega) = \mid H(\omega)\mid^2 S_g(\omega)$ e a função de transferência de um diferenciador
é $j\omega$ tem-se
\[
S_y(\omega) = \mid j\omega\mid^2 S_g(\omega) = \omega^2 S_g(\omega) = \frac{\mathcal{N}}{A^2}\omega^2
\]

O valor médio será dado por
\begin{eqnarray}
\overline{y^{2}(t)} &=& 2\int_{0}^{\infty}S_y(\omega)df = \int_{0}^{\infty}\frac{\omega^2\mathcal{N}}{A^2}df \nonumber \\
&=& 2\int_{0}^{B}(2\pi f)^2 \frac{\mathcal{N}}{A^2}df = \frac{2\mathcal{N}}{A^2}\int_{0}^{B}4\pi^2f^2df \nonumber \\
&=& \frac{8\pi^2\mathcal{N}B^3}{3A^2}volt^2
\end{eqnarray}

\begin{exemplo}Mostre que se $g(t)$ tem uma PSD $S_g(\omega)$ e potência $P_g$, então $a g(t)$ tem PSD $a^2S_g(\omega)$ e potência
$a^2P_g$
\end{exemplo}

\subsubsection{Solução}
\[
y(t)=ag(t) \leftrightarrow Y(\omega) = aG(\omega) = H(\omega)G(\omega)
\]
sendo $H(\omega) =a$,  logo temos
\[
S_y(\omega) = \mid H(\omega)\mid^2S_g(\omega) = a^2S_g
\]
Isto significa que multiplicar um sinal por um fator $a$ aumenta sua PSD por um fator $a^2$.

\begin{exemplo} Seja um trem de pulsos binários aleatórios, como mostrado na Figura~\ref{fig:pulsosbinariosaleatorios}.
Determine a função de autocorrelação, a PSD e a largura de faixa essencial de $g(t)$.
\end{exemplo}


%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/pulsosbinariosaleatorios.eps,width=8cm}}
\caption{\label{fig:pulsosbinariosaleatorios} Pulsos Binários Aleatórios.}
\end{figure}
%*******************

Temos que 
\[
R_g(t) = \lim_{T\rightarrow\infty}\frac{1}{T}\int_{-T/2}^{T/2}g(t)g(t-\tau)d\tau
\]
para obter o integrando precisamos multiplicar $g(t)$ por $g(t-\tau)$ ($g(t)$ deslocada), e então achar a 
área sob o produto $g(t)g(t-\tau)$.

Primeiro vamos observar a Figura~\ref{fig:pulsosbinariosaleatoriosdeslocados} e considerar $0 < \tau < T_0/2$.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/pulsosbinariosaleatoriosdeslocados.eps,width=8cm}}
\caption{\label{fig:pulsosbinariosaleatoriosdeslocados} Pulsos Binários aleatórios deslocados.}
\end{figure}
%*******************
como os pulsos são positivos ou negativos, o produto $g(t)g(t-\tau)$ é sempre positivo e a área de um pulso será
$A_p = T_0/2-\tau$.

Considerando um intervalo $T=NT_0$ temos $N$ pulsos sobre o intervalo, a área total é a soma das áreas de cada 
pulso individual, assim $A_T = N(T_0/2 - \tau)$ e
\begin{eqnarray}
R_g(\tau) &=& \lim_{T\rightarrow\infty}\frac{1}{T}[N(T_0/2-\tau)] \nonumber \\
&=& \lim_{N\rightarrow\infty}\frac{1}{NT_0}[N(T_0/2-\tau)] \nonumber \\
&=& \frac{1}{T_0}\left(\frac{T_0}{2}-\tau\right) = \frac{1}{2}\left(2- \frac{2\tau}{T_0}\right) \text{ para } 0<\tau<T_0/2
\end{eqnarray}

Como $R_g(\tau)$ é uma função par
\[
R_g(\tau) = \frac{1}{2}\left(1-\frac{2\mid\tau\mid}{T_0}\right) \mid\tau\mid < T_0/2
\]
e tem o formato mostrado na Figura~\ref{fig:autocorrelacaopulsosbinarios}.

%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/autocorrelacaopulsosbinarios.eps,width=5cm}}
\caption{\label{fig:autocorrelacaopulsosbinarios} Função de autocorrelação de pulsos binários aleatórios.}
\end{figure}
%*******************

Consideremos agora o caso de $\tau > t_0/2$. Haverá sobreposição do pulso com seu vizinho, ou seja, teremos
pulsos positivos e negativos no produto $g(t)g(t-\tau)$. Como os pulsos são equiprováveis, num tempo $T\rightarrow\infty$
teremos produtos $g(t)g(t-\tau)$ positivos e negativos equiprováveis. Ou seja, metade dos pulsos são positivos 
e metada são negativos (quando $T\rightarrow\infty$) resultando numa área total nula. Ou seja,
\[
R_g(\tau)=0 \text{ para } \mid\tau\mid>T_0/2
\]
e a função de autocorrelação é a mostrada na Figura~\ref{fig:autocorrelacaopulsosbinarios}.

A DEP $S_g(\omega) = \mathcal{F}[R_g(\tau)]$ que para um pulso triangular é
\[
S_g(\omega)=\frac{T_0}{4}sinc^2\left(\frac{\omega T_0}{4\pi}\right)
\]
cujo formato está representado na Figura~\ref{fig:psdpulsotriangular}.


%*******************
\begin{figure}[h]
\centerline{\psfig{figure=./Figuras/psdpulsotriangular.eps,width=8cm}}
\caption{\label{fig:psdpulsotriangular} PSD do pulso triangular.}
\end{figure}
%*******************

Calculando a área abaixo de $S_g(\omega)$ para $\mid\omega\mid < 4\pi/T_0$ em relação a área total,
verificamos que 90,28\% da potência do sinal está dentro dessa faixa, e portanto esta pode ser considerada
a largura de faixa essencial de $g(t)$ para a maioria dos casos práticos.

Este exemplo mostra um sinal não determinístico que não pode ser expresso por uma função determinística no tempo.
Consequentemente não podemos expressar seu espectro de frequência. Mas a função de autocorrelação nos permite
obter informação sobre o espectro desses sinais que seria impossível por meios convencionais.
